const nombreUsuario = document.getElementById('name');
const apellidoUsuario = document.getElementById('apellido');
const cargoUsuario = document.getElementById('cargo');
const correoUsuario = document.getElementById('mail');
const telefonoUsuario = document.getElementById('phone');
const empresaUsuario = document.getElementById('empresa');
const btnData = document.getElementById('sendData');
const inpts = document.querySelectorAll('.validate');
const selIndustria = document.getElementById('industria');
const selEmpleados = document.getElementById('empleados');


// btnData.addEventListener('click', function() {
//     window.location.href = 'thanks.php'
// });

inpts.forEach(element => {
    element.addEventListener('focusout', function() {
        let inptsValid = document.querySelectorAll('.is-valid').length + 1;
        if((inpts.length === (inptsValid))) {
            btnData.removeAttribute('disabled');
        } else {
            btnData.setAttribute('disabled', true);
        }
    })
});

nombreUsuario.addEventListener('focusout', function() {
    validateString(this, this.value);
});

apellidoUsuario.addEventListener('focusout', function() {
    validateString(this, this.value);
});

cargoUsuario.addEventListener('focusout', function() {
    validateString(this, this.value);
});

correoUsuario.addEventListener('focusout', function() {
    validateMail(this, this.value);
});

telefonoUsuario.addEventListener('focusout', function() {
    validateNumber(this, this.value);
});

empresaUsuario.addEventListener('focusout', function() {
    validateString(this, this.value);
});

/**
 * @author Juan Carlos Cárdenas
 * @param {Object} objInp - La etiqueta que se obtiene
 * @param {String} strInp - El valor de la etiqueta
 * @returns {Boolean} - True si se cumple que no es vacio y sólo contiene letras
 */
function validateString(objInp, strInp) {
    let reg = /^[a-zA-Z\u00C0-\u00FF\s]*$/;
    clearStyles(objInp)
    if(strInp != '' && reg.test(strInp)) {
        objInp.classList.add('is-valid');
        return true;
    } else {
        objInp.classList.add('is-invalid');
        return false;
    }
}

/**
 * @author Juan Carlos Cárdenas
 * @param {Object} objInp - La etiqueta que se obtiene
 * @param {String} numInp - El valor de la etiqueta
 * @returns {Boolean} - True si se cumple que no es vacio y sólo contiene números
 */

function validateNumber(objInp, numInp) {
    let reg = /^\d+$/
    clearStyles(objInp);
    if(numInp != '' && reg.test(numInp)) {
        objInp.classList.add('is-valid');
        return true;
    } else {
        objInp.classList.add('is-invalid');
        return false;
    }
}

/**
 * @author Juan Carlos Cárdenas
 * @param {Object} objInp - La etiqueta que se obtiene
 * @param {String} strInp - El valor de la etiqueta
 * @returns {Boolean} - True si se cumple que no es vacio y tiene estructura correcta de mail
 */

function validateMail(objInp, strInp) {
    let reg = /^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
    clearStyles(objInp);
    if(strInp != '' && reg.test(strInp)) {
        objInp.classList.add('is-valid');
        return true;
    } else {
        objInp.classList.add('is-invalid');
        return false;
    }
}

function clearStyles(objElem) {
    objElem.classList.remove('is-valid');
    objElem.classList.remove('is-invalid');
}

// $(document).ready(() => {

//     $('#sendData').click(() => {
//         const json = {
//             'name': nombreUsuario.value,
//             'apellido': apellidoUsuario.value,
//             'mail': correoUsuario.value,
//             'phone': telefonoUsuario.value,
//             'cargo': cargoUsuario.value,
//             'empresa': empresaUsuario.value,
//             'industria': selIndustria.value,
//             'empleados': selEmpleados.value
//         }
//         console.log(json);
//         $.ajax({
//             type: "POST",
//             url: 'insertLeads.php',
//             dataType: "JSON",
//             contentType: 'application/json',
//             data: JSON.stringify(json),
//             success: response => {
//                 alert(response);
//                 console.log(response);
//             },
//             error: err => {
//                 console.log(err);
//             }
//         });
//     }); 
// });